(this["webpackJsonpreact-webapp"]=this["webpackJsonpreact-webapp"]||[]).push([[0],{27:function(e,t,c){},30:function(e,t,c){"use strict";c.r(t);var n=c(2),r=c.n(n),o=c(19),a=c.n(o),s=(c(27),c(1)),i=c(4),u=c(6),l=c(5),d=c(16),h=c(31),p=c(32),j=c(20),b=function e(){var t=this;if(Object(s.a)(this,e),!e.instance){this.url="http://localhost:8080/ws-rest-server/api/";var c=localStorage.getItem("Access-Token");this.behaviorSubject=new h.a({logged:null!=c}),this.currentData=this.behaviorSubject.asObservable(),this.updateLogged=function(e){t.behaviorSubject.next(e)},this.getCurrent=function(){return t.currentData},this.login=function(e,c){return p.a.post("".concat(t.url,"auth?username=").concat(e,"&password=").concat(c)).pipe(Object(j.a)((function(e){localStorage.setItem("Access-Token",e.xhr.getResponseHeader("access-token"))})))},this.logout=function(){localStorage.removeItem("Access-Token"),localStorage.removeItem("tipoProductos"),localStorage.removeItem("username"),t.updateLogged({logged:!1})},this.getUserName=function(){var e=atob(localStorage.getItem("Access-Token")),t="";return e&&(t=e.split(":")[0]),t}}return e.instance=this,this},m=new b;Object.freeze(m);var v=b,g=function e(){var t=this;return Object(s.a)(this,e),e.instance||(this.mensajeSubjet=new h.a({}),this.currentData=this.mensajeSubjet.asObservable(),this.getCurrent=function(){return t.currentData},this.error=function(e){var c={mensaje:e.message||"Error inesperado",type:"alert alert-danger"};t.mensajeSubjet.next(c),setTimeout((function(){t.clearMessage()}),2500)},this.success=function(e){var c={mensaje:e,type:"alert alert-success"};t.mensajeSubjet.next(c),setTimeout((function(){t.clearMessage()}),2500)},this.clearMessage=function(){t.mensajeSubjet.next({mensaje:null,type:null})}),e.instance=this,this},f=new g;Object.freeze(f);var O=g,x=c(0),S=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;return Object(s.a)(this,c),(e=t.call(this)).login=function(t){t.preventDefault(),e.appService.login(e.state.username,e.state.password).subscribe((function(t){e.appService.updateLogged({logged:!0}),e.mensajeriaService.clearMessage()}),(function(t){e.mensajeriaService.error(t)}))},e.state={username:"",password:""},e.appService=v.instance,e.mensajeriaService=O.instance,e.handleChange=function(t){e.setState(Object(d.a)({},t.target.name,t.target.value))},e}return Object(i.a)(c,[{key:"componentWillUnmount",value:function(){this.mensajeriaService.clearMessage()}},{key:"render",value:function(){return Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-12",children:Object(x.jsxs)("form",{onSubmit:this.login,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"User Name"}),Object(x.jsx)("input",{name:"username",id:"username",type:"text",className:"form-control",vaue:this.state.username,onChange:this.handleChange})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Password"}),Object(x.jsx)("input",{name:"password",id:"password",type:"password",className:"form-control",value:this.state.password,onChange:this.handleChange})]}),Object(x.jsx)("button",{className:"btn btn-primary",children:"Login"})]})})})}}]),c}(r.a.Component),P=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;return Object(s.a)(this,c),(e=t.call(this)).state={mensaje:null,type:null},e.mensajeriaService=O.instance,e}return Object(i.a)(c,[{key:"render",value:function(){var e="col-12 ".concat(this.state.type," alert-dismissible fade show");return Object(x.jsx)(x.Fragment,{children:null!=this.state.mensaje&&Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:e,role:"alert",children:[this.state.mensaje,Object(x.jsx)("button",{type:"button",onClick:this.mensajeriaService.clearMessage,className:"close","data-dismiss":"alert","aria-label":"Close",children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})})})}},{key:"componentDidMount",value:function(){var e=this;this.mensajeriaService.getCurrent().subscribe((function(t){return e.setState({mensaje:t.mensaje,type:t.type})}))}}]),c}(r.a.Component),C=function e(){var t=this;return Object(s.a)(this,e),e.instance||(this.mensajeSubject=new h.a([]),this.currentData=this.mensajeSubject.asObservable(),this.updateProductos=function(e){t.mensajeSubject.next(e)},this.getProductos=function(){return t.currentData},this.getProductosValue=function(){return t.currentData.source.value}),e.instance=this,this},N=new C;Object.freeze(N);var y=C,w=function e(){var t=this;if(Object(s.a)(this,e),!e.instance)return this.httpClient=p.a,this.productoDataService=y.instance,this.mensajeriaService=O.instance,this.url="http://localhost:8080/ws-rest-server/",this.api="api/productos",this.searchUrl="api/productos/filtro/",this.tipoProductoApi="api/tipoproducto",this.subject=new h.a([]),this.subscription=this.subject.asObservable(),this.findAll=function(){return t.httpClient.get("".concat(t.url).concat(t.api))},this.search=function(e){return t.httpClient.get("".concat(t.url).concat(t.searchUrl).concat(e)).pipe(Object(j.a)((function(e){var c=e.response;return t.productoDataService.updateProductos(c),e})))},this.deleteProducto=function(e){return t.httpClient.delete("".concat(t.url).concat(t.api,"/").concat(e),{Authorization:"Basic ".concat(localStorage.getItem("Access-Token"))}).pipe(Object(j.a)((function(c){var n=t.productoDataService.getProductosValue();return n=n.filter((function(t){return t.codigo!==e})),t.productoDataService.updateProductos(n),c})))},this.createProducto=function(e){return t.httpClient.post("".concat(t.url).concat(t.api),e,{Authorization:"Basic ".concat(localStorage.getItem("Access-Token")),"Content-Type":"application/json"}).pipe(Object(j.a)((function(e){var c=t.productoDataService.getProductosValue();return c.push(e.response),t.productoDataService.updateProductos(c),e})))},this.findTiposProductos=function(){return t.httpClient.get("".concat(t.url).concat(t.tipoProductoApi))},e.instance=this,this},D=new w;Object.freeze(D);var k=w,T=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;return Object(s.a)(this,c),(e=t.call(this)).state={codigo:"",titulo:"",precio:"",tipoProducto:"",tiposProductos:[],tituloBusqueda:""},e.productoService=k.instance,e.productoDataService=y.instance,e.mensajeriaService=O.instance,e.handleChange=function(t){var c="checkbox"===t.target.type;e.setState(Object(d.a)({},t.target.name,c?t.target.checked:t.target.value))},e.handleChangeSelect=function(t){e.setState({tipoProducto:t.target.value})},e.createProducto=function(t){t.preventDefault();var c={codigo:e.state.codigo,titulo:e.state.titulo,precio:e.state.precio,tipoProducto:{id:e.state.tipoProducto}};e.productoService.createProducto(c).subscribe((function(t){console.log(t.response),e.setState({codigo:"",titulo:"",precio:"",tipoProducto:{id:0}}),e.mensajeriaService.success("Se ha creado exitosamente el producto")}),(function(t){e.mensajeriaService.error("No se ha creado exitosamente el producto, ".concat(t))}))},e.buscarProducto=function(t){t.preventDefault(),e.state.tituloBusqueda?e.productoService.search(e.state.tituloBusqueda).subscribe((function(t){e.productoDataService.updateProductos(t.response)}),(function(t){e.mensajeriaService.error(t)})):e.productoService.findAll().subscribe((function(t){e.productoDataService.updateProductos(t.response)}),(function(t){e.mensajeriaService.error(t)}))},e}return Object(i.a)(c,[{key:"componentDidMount",value:function(){var e=this;this.productoService.findTiposProductos().subscribe((function(t){var c=t.response;localStorage.setItem("tiposProductos",JSON.stringify(c)),e.setState({tiposProductos:c})}))}},{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("tiposProductos"))||[];return Object(x.jsxs)("div",{className:"row mt-3",children:[Object(x.jsx)("div",{className:"col-6",children:Object(x.jsxs)("form",{onSubmit:this.buscarProducto,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"tituloBusqueda",children:"T\xedtulo"}),Object(x.jsx)("input",{type:"text",className:"form-control",name:"tituloBusqueda",id:"tituloBusqueda",value:this.tituloBusqueda,onChange:this.handleChange})]}),Object(x.jsx)("button",{className:"btn btn-primary",children:"Buscar Productos"})]})}),Object(x.jsx)("div",{className:"col-6",children:Object(x.jsxs)("form",{onSubmit:this.createProducto,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"codigo",children:"Codigo"}),Object(x.jsx)("input",{type:"text",className:"form-control",name:"codigo",id:"codigo",value:this.state.codigo,onChange:this.handleChange})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"T\xedtulo"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"password",name:"titulo",value:this.state.titulo,onChange:this.handleChange})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"precio",children:"Precio"}),Object(x.jsx)("input",{type:"text",className:"form-control",name:"precio",id:"precio",value:this.state.precio,onChange:this.handleChange})]}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("select",{className:"custom-select",id:"tipoProducto","aria-label":"Example select with button addon",value:this.state.tipoProducto,onChange:this.handleChangeSelect,children:e.map((function(e,t){return Object(x.jsx)("option",{id:t,value:e.id,children:e.descripcion},t)}))})}),Object(x.jsx)("button",{className:"btn btn-success",children:"Grabar"})]})})]})}}]),c}(r.a.Component),A=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;return Object(s.a)(this,c),(e=t.call(this)).logout=function(t){t.preventDefault(),window.confirm("\xbfEst\xe1 seguro?")&&e.appService.logout()},e.state={username:""},e.appService=b.instance,e}return Object(i.a)(c,[{key:"componentDidMount",value:function(){var e=this.appService.getUserName();this.setState({username:e})}},{key:"render",value:function(){return Object(x.jsxs)("nav",{className:"navbar navbar-light",children:[Object(x.jsxs)("a",{className:"navbar-brand",children:["Usuario: ",this.state.username]}),Object(x.jsx)("button",{className:"btn btn-info my-2 my-sm-0",type:"submit",onClick:this.logout,children:"Logout"})]})}}]),c}(r.a.Component),I=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;return Object(s.a)(this,c),(e=t.call(this)).productoService=k.instance,e.mensajeriaService=O.instance,e.deleteProducto=function(t){window.confirm("Desea eliminar")&&e.productoService.deleteProducto(t).subscribe((function(c){e.mensajeriaService.success("Se ha eliminado exitosamente el producto ".concat(t))}),(function(c){console.log(c),e.mensajeriaService.error({message:"NO se ha eliminado exitosamente el producto ".concat(t)})}))},e}return Object(i.a)(c,[{key:"render",value:function(){var e=this;return Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{scope:"row",children:this.props.producto.id}),Object(x.jsx)("th",{children:this.props.producto.codigo}),Object(x.jsx)("td",{children:this.props.producto.titulo}),Object(x.jsx)("td",{children:this.props.producto.precio}),Object(x.jsx)("td",{children:this.props.producto.tipoProducto.descripcion}),Object(x.jsxs)("td",{children:[Object(x.jsx)("button",{className:"btn btn-danger",onClick:function(t){return e.deleteProducto(e.props.producto.codigo)},children:"Eliminar"}),Object(x.jsx)("button",{className:"btn btn-primary ml-2",onClick:function(t){return e.editarProducto(e.props.producto)},children:"Editar"})]})]})}}]),c}(r.a.Component),B=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;return Object(s.a)(this,c),(e=t.call(this)).state={productos:[]},e.productoDataService=y.instance,e.productoService=k.instance,e}return Object(i.a)(c,[{key:"componentDidMount",value:function(){var e=this;this.productoService.findAll().subscribe((function(t){e.productoDataService.updateProductos(t.response)})),this.productoDataService.getProductos().subscribe((function(t){return e.setState({productos:t})}))}},{key:"render",value:function(){return Object(x.jsx)("div",{className:"row mt-3",children:Object(x.jsx)("div",{className:"col-12",children:Object(x.jsxs)("table",{className:"table",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{scope:"col",children:"#"}),Object(x.jsx)("th",{scope:"col",children:"T\xedtulo"}),Object(x.jsx)("th",{scope:"col",children:"Precio"}),Object(x.jsx)("th",{scope:"col",children:"Codigo"}),Object(x.jsx)("th",{scope:"col",children:"Tipo"}),Object(x.jsx)("th",{scope:"col"})]})}),Object(x.jsx)("tbody",{children:this.state.productos.map((function(e,t){return Object(x.jsx)(I,{producto:e,children:" "},t)}))})]})})})}}]),c}(r.a.Component),M=function(e){Object(u.a)(c,e);var t=Object(l.a)(c);function c(){var e;Object(s.a)(this,c),e=t.call(this);var n=localStorage.getItem("Access-Token");return e.state={logged:null!=n},e.appService=b.instance,e}return Object(i.a)(c,[{key:"render",value:function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(P,{}),this.state.logged&&Object(x.jsx)(A,{}),!this.state.logged&&Object(x.jsx)(S,{}),this.state.logged&&Object(x.jsx)(T,{}),this.state.logged&&Object(x.jsx)(B,{productos:this.state.productos})]})}},{key:"componentDidMount",value:function(){var e=this;this.appService.getCurrent().subscribe((function(t){e.setState({logged:t.logged})}))}}]),c}(r.a.Component);var F=function(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(M,{})})},q=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,33)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;c(e),n(e),r(e),o(e),a(e)}))};a.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(F,{})}),document.getElementById("root")),q()}},[[30,1,2]]]);
//# sourceMappingURL=main.cd72acdb.chunk.js.map